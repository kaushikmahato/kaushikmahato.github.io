<!DOCTYPE html>
<html>

<!--
    This file is a standalone HTML page demonstrating usage of the Authorize.net
    Accept JavaScript library using the integrated payment information form.

    For complete documentation for the Accept JavaScript library, see
    https://developer.authorize.net/api/reference/features/acceptjs.html
-->

<head>
    <title>Sample ACCEPT Form</title>
</head>

<body>

<script type="text/javascript"
    src="https://jstest.authorize.net/v3/AcceptUI.js"
    charset="utf-8">
</script>
<h2>Merchant Store</h2>
    <h3>Merchant Details</h3>
    <li>Authorize.Net AccountID 676177</li>
        <li>username: hackdev1</li>
        <li>password: Hackdev1</li>
        <li>apiLoginId: 244dkNUJcH</li>
        <li>TransactionKey: 34yuE4pN7y8nM3Qr</li>
        <li>Public Client Key: 7ysxr65RL6ZDp9dPqSGbAk75k9nS4sDCPbGAbhFnv2Yw399cTUrMTv928rp8EFcA</li>
    <hr/>
<form id="paymentForm"
    method="POST"
    action="https://kaushikmahato.github.io/visa/test/acceptUI-1.html">
    <input type="hidden" name="dataValue" id="dataValue" />
    <input type="hidden" name="dataDescriptor" id="dataDescriptor" />
    <button type="button"
        class="AcceptUI"
        data-billingAddressOptions='{"show":true, "required":false}'
        data-apiLoginID="244dkNUJcH"
        data-clientKey="7ysxr65RL6ZDp9dPqSGbAk75k9nS4sDCPbGAbhFnv2Yw399cTUrMTv928rp8EFcA"
        data-acceptUIFormBtnTxt="Submit"
        data-acceptUIFormHeaderTxt="Card Information"
        data-responseHandler="responseHandler">Pay
    </button>
</form>

<script type="text/javascript">

function responseHandler(response) {
    if (response.messages.resultCode === "Error") {
        var i = 0;
        while (i < response.messages.message.length) {
            console.log(
                response.messages.message[i].code + ": " +
                response.messages.message[i].text
            );
            i = i + 1;
        }
    } else {
        console.log("Token Received");
        console.log(response.opaqueData.dataDescriptor);
        console.log(response.opaqueData.dataValue);
//        paymentFormUpdate(response.opaqueData);
    }
}


function paymentFormUpdate(opaqueData) {
    document.getElementById("dataDescriptor").value = opaqueData.dataDescriptor;
    document.getElementById("dataValue").value = opaqueData.dataValue;

    // If using your own form to collect the sensitive data from the customer,
    // blank out the fields before submitting them to your server.
    // document.getElementById("cardNumber").value = "";
    // document.getElementById("expMonth").value = "";
    // document.getElementById("expYear").value = "";
    // document.getElementById("cardCode").value = "";

    document.getElementById("paymentForm").submit();
}
</script>

</body>
</html>
